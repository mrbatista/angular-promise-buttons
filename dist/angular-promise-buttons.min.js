angular.module("angularPromiseButtons",[]),angular.module("angularPromiseButtons").directive("promiseBtn",["angularPromiseButtons","$compile","$parse",function(a,b,c){"use strict";var d="click",e="ngClick",f="submit",g="ngSubmit";return{restrict:"EA",priority:a.config.priority,scope:{promiseBtn:"=",promiseBtnOptions:"=?"},link:function(h,i,j){function k(a){u.btnLoadingClass&&!u.addClassToCurrentBtnOnly&&a.addClass(u.btnLoadingClass),u.disableBtn&&!u.disableCurrentBtnOnly&&a.attr("disabled","disabled")}function l(a){u.btnLoadingClass&&a.removeClass(u.btnLoadingClass),u.disableBtn&&a.removeAttr("disabled")}function m(a,b){h.$watch(a,function(a){a&&a.then?(k(b),a.finally(function(){l(b)})):a&&a.$promise&&(k(b),a.$promise.finally(function(){l(b)}))})}function n(a){return a.split(";").map(function(a){return c(a)})}function o(a){a.append(b(u.spinnerTpl)(h))}function p(a){u.addClassToCurrentBtnOnly&&a.on(d,function(){a.addClass(u.btnLoadingClass)}),u.disableCurrentBtnOnly&&a.on(d,function(){a.attr("disabled","disabled")})}function q(a,b,c){h.$evalAsync(function(){var d=n(j[b]);i.unbind(a),i.bind(a,function(){h.$apply(function(){d.forEach(function(b){var d=b(h.$parent,{$event:a});s||(s=m(function(){return d},c))})})})})}function r(a){for(var b=[],c=a.find("button"),d=0;d<c.length;d++){var e=c[d];"submit"===angular.element(e).attr("type")&&b.push(e)}return angular.element(b)}var s,t=a.config,u=t;if(j.promiseBtn)o(i),p(i),m(function(){return h.promiseBtn},i);else if(j.hasOwnProperty(e))o(i),p(i),q(d,e,i);else if(j.hasOwnProperty(g)){var v=r(i);o(v),p(v),q(f,g,v)}h.$watch("promiseBtnOptions",function(a){angular.isObject(a)&&(u=angular.extend({},t,a))},!0)}}}]),angular.module("angularPromiseButtons").provider("angularPromiseButtons",function(){"use strict";var a={spinnerTpl:'<span class="btn-spinner"></span>',priority:0,disableBtn:!0,btnLoadingClass:"is-loading",addClassToCurrentBtnOnly:!1,disableCurrentBtnOnly:!1};return{extendConfig:function(b){a=angular.extend(a,b)},$get:function(){return{config:a}}}});